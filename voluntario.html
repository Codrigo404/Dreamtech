<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dream Tech | Voluntariado</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/voluntario.css">
</head>
<body class="dark-mode volunteer-mode">

    <header class="header">
        <div class="logo"><span>Dream</span>Tech.</div>
        <nav class="navbar">
            <a href="index.html">Home</a>
            <a href="sobreNos.html">Sobre N√≥s</a>
            <a href="acoesSociais.html">A√ß√µes Sociais</a>
            <a href="instituto.html">Instituto</a>
            <a href="voluntario.html" class="active">Seja Volunt√°rio</a>
        </nav>
        <div class="header-actions">
            <button id="theme-toggle" class="btn-theme">‚òÄÔ∏è</button>
        </div>
    </header>

    <main>
        <section class="hero-volunteer">
            <div class="hero-overlay">
                <h1>Junte-se √† Nossa Miss√£o</h1>
                <p>Use seu talento para construir pontes e derrubar barreiras.</p>
            </div>
        </section>

        <section class="container invite-section">
            <div class="invite-content">
                <h2>Voc√™ mora perto? Acredita na tecnologia?</h2>
                <p class="intro-text">
                    Precisamos de <strong>Apoiadores Locais</strong> para fazer esse sonho chegar em cada esquina.
                </p>

                <ul class="volunteer-list">
                    <li>
                        <div class="icon-check"><i class="fa-solid fa-bullhorn"></i></div>
                        <div class="text-check">
                            <strong>Divulga√ß√£o:</strong> Leve a palavra da Dream Tech para escolas, igrejas e associa√ß√µes do seu bairro.
                        </div>
                    </li>
                    <li>
                        <div class="icon-check"><i class="fa-solid fa-hand-holding-heart"></i></div>
                        <div class="text-check">
                            <strong>Voluntariado em Campanhas:</strong> Ajude na organiza√ß√£o das nossas a√ß√µes sociais e eventos.
                        </div>
                    </li>
                    <li>
                        <div class="icon-check"><i class="fa-solid fa-eye"></i></div>
                        <div class="text-check">
                            <strong>Fique de Olho:</strong> Os volunt√°rios mais engajados s√£o os primeiros a serem selecionados para vagas na nossa equipe!
                        </div>
                    </li>
                    <li>
                        <div class="icon-check"><i class="fa-solid fa-rocket"></i></div>
                        <div class="text-check">
                            <strong>Carreira Dreamer:</strong> Oportunidade real de vir trabalhar conosco no futuro.
                        </div>
                    </li>
                </ul>
            </div>
        </section>

        <section class="container form-wrapper">
            
            <form id="volunteerForm" autocomplete="off" class="vol-form">
                
                <input type="hidden" id="idVoluntario">

                <div class="form-section-header">
                    <i class="fa-solid fa-user-astronaut"></i>
                    <h2>Dados Pessoais</h2>
                </div>

                <div class="input-grid">
                    <div class="input-box full-width">
                        <label>Nome Completo</label>
                        <input type="text" id="nome" required placeholder="Seu nome completo">
                    </div>
                    
                    <div class="input-box">
                        <label>CPF</label>
                        <input type="text" id="cpf" required placeholder="000.000.000-00" maxlength="14">
                    </div>

                    <div class="input-box">
                        <label>Data de Nascimento</label>
                        <input type="date" id="nascimento" required>
                    </div>
                </div>

                <div class="form-section-header">
                    <i class="fa-solid fa-map-pin"></i>
                    <h2>Onde voc√™ est√°?</h2>
                </div>

                <div class="input-grid">
                    <div class="input-box">
                        <label>CEP</label>
                        <input type="text" id="cep" placeholder="00000-000" maxlength="9">
                    </div>
                    <div class="input-box full-width">
                        <label>Endere√ßo Completo</label>
                        <input type="text" id="endereco" required placeholder="Rua, n√∫mero, bairro...">
                    </div>
                </div>

                <div class="form-section-header">
                    <i class="fa-solid fa-hands-holding-circle"></i>
                    <h2>Como voc√™ quer ajudar?</h2>
                </div>

                <div class="input-grid">
                    <div class="input-box">
                        <label>WhatsApp / Celular</label>
                        <input type="tel" id="telefone" required placeholder="(21) 99999-9999" maxlength="15">
                    </div>
                    
                    <div class="input-box">
                        <label>√Årea de Interesse</label>
                        <select id="area">
                            <option value="">Selecione...</option>
                            <option value="Divulgacao">Divulga√ß√£o Local</option>
                            <option value="Eventos">Apoio em Eventos</option>
                            <option value="Ensino">Ensino / Professor</option>
                            <option value="Logistica">Log√≠stica e Transporte</option>
                            <option value="Mentoria">Mentoria de Carreira</option>
                        </select>
                    </div>

                    <div class="input-box full-width">
                        <label>Sua Motiva√ß√£o (Conte um pouco sobre voc√™)</label>
                        <textarea id="motivacao" rows="3" placeholder="Por que voc√™ quer ser um volunt√°rio Dream Tech?"></textarea>
                    </div>
                </div>

                <div class="form-footer">
                    <button type="submit" id="btnSalvar" class="btn-cyan">Confirmar Inscri√ß√£o</button>
                    <button type="button" id="btnCancelar" class="btn-outline" style="display: none;" onclick="cancelarEdicao()">Cancelar</button>
                </div>

            </form>

            <div class="volunteers-list">
                <h3><i class="fa-solid fa-users"></i> Nossa Equipe de Volunt√°rios</h3>
                <div class="table-responsive">
                    <table class="vol-table">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Contato</th>
                                <th>√Årea</th>
                                <th>Localiza√ß√£o</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="tabelaCorpo">
                            </tbody>
                    </table>
                    <p id="msgVazio" class="empty-msg">Nenhum volunt√°rio cadastrado ainda.</p>
                </div>
            </div>

        </section>
    </main>

    <footer>
        <p>&copy; 2025 Iniciativa Dream Tech. Todos os direitos reservados.</p>
    </footer>

    <script src="JS/index.js"></script>

    <script>
    (function () {
        const KEY_DB = 'dreamtech_db_voluntarios';
        
        // --- 1. M√ÅSCARAS ---
        const mascaraCPF = (v) => v.replace(/\D/g, '').replace(/(\d{3})(\d)/, '$1.$2').replace(/(\d{3})(\d)/, '$1.$2').replace(/(\d{3})(\d{1,2})/, '$1-$2').replace(/(-\d{2})\d+?$/, '$1');
        const mascaraTel = (v) => v.replace(/\D/g, '').replace(/(\d{2})(\d)/, '($1) $2').replace(/(\d{5})(\d)/, '$1-$2').replace(/(-\d{4})\d+?$/, '$1');
        const mascaraCEP = (v) => v.replace(/\D/g, '').replace(/^(\d{5})(\d)/, '$1-$2').replace(/(-\d{3})\d+?$/, '$1');

        document.getElementById('cpf').addEventListener('input', e => e.target.value = mascaraCPF(e.target.value));
        document.getElementById('telefone').addEventListener('input', e => e.target.value = mascaraTel(e.target.value));
        
        const inputCep = document.getElementById('cep');
        inputCep.addEventListener('input', e => {
            let valor = e.target.value;
            e.target.value = mascaraCEP(valor);
            // Busca autom√°tica ao completar o CEP
            if(valor.length === 9) buscarEndereco(valor);
        });

        // --- 2. BUSCA VIA CEP ---
        function buscarEndereco(cep) {
            const campoEnd = document.getElementById('endereco');
            const cleanCep = cep.replace(/\D/g, '');
            
            if(cleanCep.length === 8) {
                campoEnd.value = "Consultando...";
                campoEnd.disabled = true;

                fetch(`https://viacep.com.br/ws/${cleanCep}/json/`)
                    .then(r => r.json())
                    .then(d => {
                        if(!d.erro) campoEnd.value = `${d.logradouro}, ${d.bairro} - ${d.localidade}/${d.uf}`;
                        else { alert('CEP n√£o encontrado'); campoEnd.value = ''; }
                    })
                    .finally(() => campoEnd.disabled = false);
            }
        }

        // --- 3. CRUD (Banco de Dados) ---
        const lerBD = () => JSON.parse(localStorage.getItem(KEY_DB)) ?? [];
        const setBD = (db) => localStorage.setItem(KEY_DB, JSON.stringify(db));

        const salvarVoluntario = (e) => {
            e.preventDefault();
            const vol = {
                id: document.getElementById('idVoluntario').value || new Date().getTime().toString(),
                nome: document.getElementById('nome').value,
                cpf: document.getElementById('cpf').value,
                nascimento: document.getElementById('nascimento').value,
                cep: document.getElementById('cep').value,
                endereco: document.getElementById('endereco').value,
                telefone: document.getElementById('telefone').value,
                area: document.getElementById('area').value,
                motivacao: document.getElementById('motivacao').value
            };

            const db = lerBD();
            const index = db.findIndex(x => x.id == vol.id);

            if(index == -1) {
                db.push(vol);
                alert("Inscri√ß√£o realizada! Bem-vindo(a) ao time Dreamer! üöÄ");
            } else {
                db[index] = vol;
                alert("Cadastro atualizado com sucesso.");
            }

            setBD(db);
            limpar();
            listar();
        };

        const listar = () => {
            const db = lerBD();
            const tbody = document.getElementById('tabelaCorpo');
            tbody.innerHTML = '';
            
            if(db.length === 0) {
                document.getElementById('msgVazio').style.display = 'block';
            } else {
                document.getElementById('msgVazio').style.display = 'none';
                db.forEach(p => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td><strong>${p.nome}</strong></td>
                        <td>${p.telefone}</td>
                        <td><span class="badge-area">${p.area}</span></td>
                        <td>${p.endereco.split('-')[1] || '...'}</td>
                        <td>
                            <button onclick="editar('${p.id}')" class="btn-icon edit"><i class="fa-solid fa-pen-to-square"></i></button>
                            <button onclick="excluir('${p.id}')" class="btn-icon delete"><i class="fa-solid fa-trash-can"></i></button>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
            }
        };

        const limpar = () => {
            document.getElementById('volunteerForm').reset();
            document.getElementById('idVoluntario').value = '';
            document.getElementById('btnSalvar').innerText = "Confirmar Inscri√ß√£o";
            document.getElementById('btnCancelar').style.display = 'none';
        }

        window.editar = (id) => {
            const p = lerBD().find(x => x.id == id);
            if(p) {
                document.getElementById('idVoluntario').value = p.id;
                document.getElementById('nome').value = p.nome;
                document.getElementById('cpf').value = p.cpf;
                document.getElementById('nascimento').value = p.nascimento;
                document.getElementById('cep').value = p.cep;
                document.getElementById('endereco').value = p.endereco;
                document.getElementById('telefone').value = p.telefone;
                document.getElementById('area').value = p.area;
                document.getElementById('motivacao').value = p.motivacao;

                document.getElementById('btnSalvar').innerText = "Salvar Altera√ß√µes";
                document.getElementById('btnCancelar').style.display = 'inline-block';
                document.querySelector('.vol-form').scrollIntoView({ behavior: 'smooth' });
            }
        };

        window.excluir = (id) => {
            if(confirm("Remover este volunt√°rio da lista?")) {
                const db = lerBD().filter(x => x.id != id);
                setBD(db);
                listar();
            }
        };

        window.cancelarEdicao = limpar;
        document.getElementById('volunteerForm').addEventListener('submit', salvarVoluntario);
        listar();

    })();
    </script>
</body>
</html>